minikube-init() {
    if [[ $# -ne 1 ]]; then
        echo "usage: minikube-init KUBERNETES_VERSION" >&2
        return 1
    fi
    local version=$1; shift
    command minikube status | grep -q 'minikube: Running'
    if [[ $? -ne 0 ]]; then
        command minikube start --vm-driver hyperkit --kubernetes-version "${version}" --extra-config=apiserver.Authorization.Mode=RBAC
    fi
    command minikube addons enable ingress
    eval $(command minikube docker-env)
    env | grep 'DOCKER\w\+'
    command minikube status
    kubectl config use-context minikube
}

if [ $# -eq 1 ]; then
    case "$1" in
        start) minikube start10; return $? ;;
        start10) minikube-init "v1.10.0" ; return $? ;;
    esac
fi

command minikube $@

# ex: ts=4 sw=4 et ft=sh
